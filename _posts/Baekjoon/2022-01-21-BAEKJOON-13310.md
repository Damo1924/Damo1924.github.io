---

title: "[백준] 13310. 먼 별"

toc: true

toc_label: "On this page"

toc_icon: "chevron-right"

categories:

  - PS

use_math: true

comments: true

---

`Tags` 회전하는 캘리퍼스, rotating calipers, 삼분 탐색, ternary search

## [백준] 13310. 먼 별

[백준 13310. 먼 별 문제 링크](https://www.acmicpc.net/problem/13310)

**[PROBLEM]**

매일 밤 자정에 고정된 카메라로 밤하늘의 별들을 찍은 것을 토대로 별들을 좌표평면 상의 한 점으로 표현하였다.

날마다 찍은 사진들을 비교한 결과, 어떤 별들은 항상 같은 위치에 있었고 어떤 별들은 일정한 속도로 움직이고 있었다.

이때 가장 멀리 떨어진 두 별의 거리가 최소인 촬영일과 그 때 거리의 제곱값을 구하여라.

**[INPUT]**

첫 번째 줄에 별의 개수 N과 마지막 촬영일을 나타내는 정수 T가 주어진다.

($2 \leq N \leq 30000$, $0 \leq T \leq 10^7$)

다음 N개의 줄에는 각 별의 좌표 $(x, y)$와 속도 $(dx, dy)$를 의미하는 네 정수가 주어진다.

($\left\vert x \right\vert, \left\vert y \right\vert \leq 10^7$ / $\left\vert dx \right\vert, \left\vert dy \right\vert \leq 100)

**[OUTPUT]**

첫 번째 줄에는 가장 먼 두 별 사이의 거리가 최소인 촬영일을 출력한다.

만약 이러한 촬영일이 여럿 존재한다면 그 중 가장 빠른 촬영일을 출력한다.

두 번째 줄에는 해당 최소 거리의 제곱값을 출력한다.

### [Solution] Rotating Calipers + Ternary Search

어느 촬영일의 가장 먼 두 별 사이의 거리는 회전하는 캘리퍼스 알고리즘을 이용하면 $O(N \log N)$으로 구할 수 있다.

그런데 마지막 촬영일이 최대 $10^7$까지 주어질 수 있기 때문에 모든 날짜에 대해 가장 먼 두 별 사이의 거리를 구하는 것은 불가능하다.

따라서 구하고자 하는 촬영일을 선형 탐색보다 빠르게 찾을 수 있는 방법을 생각해내야 한다.

$k$번째 별의 초기 좌표를 $(x_k, y_k)$, 속도를 $(dx_k, dy_k)$라고 하자.

임의의 자연수 $i, j \in \[1, N\]$에 대해, 촬영일 $t \in \[0, T\]$에서 $ $i$번째 별과 $j$번째 별 사이의 거리의 제곱 $d(i, j, t)$는 다음과 같다.

\begin{aligned}
d(i, j, t) = \left( (x_j + tdx_j) - (x_i + tdx_i) \right)^2 + \left( (y_j + tdy_j) - (y_i + tdy_i) \right)^2
\end{aligned}

이를 촬영일 $t$에 대한 이차함수로 정리하면,

\begin{aligned}
\left( (dx_j - dx_i)^2 + (dy_j - dy_i)^2 \right) t^2 + 2 \left( (x_j - x_i)(dx_j - dx_i) + (y_j - y_i)(dy_j - dy_i) \right) t + (x_j - x_i)^2 + (y_j - y_i)^2
\end{aligned}

따라서 모든 $i, j$에 대해 $d(i, j, t)$는 $t$에 대한 **아래로 볼록한 이차함수**이거나 **상수 함수**임을 알 수 있다.

이로부터 우리는 다음과 같은 그래프를 그려볼 수 있다.

<center><img src="" width="60%" height="60%"></center>
















