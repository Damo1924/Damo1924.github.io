---
title: "[백준] 10830. 행렬 제곱 & 13246. 행렬 제곱의 합"
toc: true
toc_label: "On this page"
toc_icon: "chevron-right"
categories:
  - PS
use_math: true
comments: true

---

## [백준] 10830. 행렬 제곱

[백준 10830. 행렬 제곱 문제 링크](https://www.acmicpc.net/problem/10830)

**[PROBLEM]**

크기가 N x N인 행렬 A가 주어졌을 때, A의 B제곱을 구해 출력한다.

**[INPUT]**

첫째 줄에 행렬의 크기 N과 B가 주어진다.

($2 \leq N \leq 5$, $1 \leq B \leq 10^{12}$)

그 다음 N개의 줄에 걸쳐 행렬 A의 각 원소가 주어진다. 행렬의 각 원소는 1,000보다 작거나 같은 음이 아닌 자연수이다.

**[OUTPUT]**

행렬 A를 B제곱한 결과의 각 원소를 1,000으로 나눈 나머지를 출력한다.


<br/>
**[SOLUTION]**

B가 매우 큰 경우에 대해서 문제를 해결하기 위해서는 분할 정복을 이용해야한다.

$2^{10} = 1024$이므로, $B = 10^{12}$의 입력이 들어와도 40번 이내의 재귀 호출이면 계산이 가능하다는 것을 알 수 있다.

분할 정복을 이용해서 행렬의 제곱을 구하는 함수를 `matrixPow()`, 행렬의 곱셈을 수행하는 함수를 `matrixMul()`라고 하면 다음과 같이 코드를 구현할 수 있다.

```cpp
#include <iostream>
using namespace std;
typedef long long ll;
const int MOD = 1000;

int N, A[5][5], P[5][5]; // N: 행렬 A의 크기, A: 행렬 A를 저장할 배열, P: A의 거듭제곱을 저장할 배열

void matrixMul (int a[][5], int b[][5]) // 두 이차원배열을 입력받아 행렬곱을 수행한 후, 각 원소를 1000으로 나눈 결과를 P에 저장
{
    int tmp[5][5]{};
    for (int i = 0; i < N; i++)
        for (int j = 0; j < N; j++)
            for (int k = 0; k < N; k++)
                tmp[i][j] += a[i][k] * b[k][j];
    
    for (int i = 0; i < N; i++)
        for (int j = 0; j < N; j++)
            P[i][j] = tmp[i][j] % MOD;            
}

void matrixPow (ll b) // A^b를 분할 정복을 통해 구하는 함수
{
    if (b == 1) return;
    matrixPow(b/2);
    matrixMul(P, P);
    if (b % 2) matrixMul(P, A);
}

int main()
{
    ll B;
    cin >> N >> B;
    for (int i = 0; i < N; i++)
    {
        for (int j = 0; j < N; j++)
        {
            int x;
            cin >> x;
            A[i][j] = x;
            P[i][j] = x;
        }
    }
    
    matrixPow(B);
    
    for (int i = 0; i < N; i++)
    {
        for (int j = 0; j < N; j++)
            cout << P[i][j] % MOD << " "; // 행렬 A의 원소가 1000이고 B가 1인 경우 0이 출력되도록 나머지 연산을 수행한다.
        cout << "\n";
    }
}
```


## [백준] 13246. 행렬 제곱의 합

[백준 13246. 행렬 제곱의 합 문제 링크](https://www.acmicpc.net/problem/13246)

**[PROBLEM]**

크기가 N x N인 행렬 A가 주어졌을 때, A의 1제곱부터 A의 B제곱까지 더한 행렬을 구해 출력한다.

즉, 다음을 계산하여 각 원소를 1000으로 나눈 나머지를 출력한다.

\begin{align\*}
S = A^1 + A^2 + \dots + A^B
\end{align\*}

**[INPUT]**

첫째 줄에 행렬의 크기 N과 B가 주어진다.

($2 \leq N \leq 5$, $1 \leq B \leq 10^{12}$)

그 다음 N개의 줄에 걸쳐 행렬 A의 각 원소가 주어진다. 행렬의 각 원소는 1,000보다 작거나 같은 음이 아닌 자연수이다.

**[OUTPUT]**

행렬 A를 B제곱한 결과의 각 원소를 1,000으로 나눈 나머지를 출력한다.


<br/>
**[SOLUTION]**

