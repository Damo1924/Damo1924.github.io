---
title: "삼분 탐색(Ternary Search)"
toc: true
toc_label: "On this page"
toc_icon: "chevron-right"
categories:
  - Algorithm
use_math: true
comments: true

---

`Tags` Parametric Search, 8986 전봇대

## 1. What is Ternary Search?

삼분 탐색은 **볼록 함수에서 극값이나 최대/최솟값을 찾을 때** 사용하는 방법이다.

이분 탐색이 항상 단조 증가/감소하는 함수에만 사용할 수 있었던 것에 비해, 삼분 탐색은 더 많은 함수에 대해 적용할 수 있다는 장점이 있다.

방법 자체는 이분 탐색과 크게 다르지 않다.

아래로 볼록한 함수 $f(x)$의 최솟값을 찾는 경우를 생각해보자.($x$는 정수값만을 가진다고 가정)

주어진 $x$값의 구간을 $\[s, e)$라고 하면, 해당 구간을 삼등분하는 두 값 $p, q$는 다음과 같다.

\begin{aligned}
p = \left\lfloor \frac{2s + e}{3} \right\rfloor, q = \left\lfloor \frac{s + 2e}{3} \right\rfloor
\end{aligned}

전체 구간은 $\[s, p)$, $\[p, q)$, $\[q, e)$로 나누어진다.

여기서 $f(p)$와 $f(q)$ 값에 따라 두 가지 경우로 나눌 수 있다.

1. $f(p) > f(q)$: 구간 $\[s, p)$에서 최솟값을 가질 수 없으므로 탐색 범위를 $\[p, e)$로 줄인다.
2. $f(p) < f(q)$: 구간 $\[q, e)$에서 최솟값을 가질 수 없으므로 탐색 범위를 $\[s, q)$로 줄인다.

위 과정을 한 번 수행할 때마다 구간의 길이가 $\frac{2}{3}$으로 줄어들기 때문에,

\begin{aligned}
T(n) = T \left( \frac{2n}{3} \right) + 1
\end{aligned}

이라 할 수 있고, 이는 master theorem에 의해 $\Theta (\log n)$의 시간복잡도를 갖는다.

> **Master Theorem**은 재귀함수의 시간복잡도를 구하는데 이용되는 정리로, 자세한 내용은 [이 포스트]()에서 다루고 있다.

<br/>

## 2. When To Use It?

단순히 볼록 함수에서 사용한다고 했으나, 그렇다고 무조건적으로 삼분 탐색을 이용할 필요는 없다.

예를 들어 미분이 가능한 볼록 함수의 경우에는 도함수가 단조 증가/감소하기 때문에 도함수를 구해서 이분탐색을 사용하면 최대/최솟값을 구할 수 있다.

이처럼 볼록 함수의 극값이나 최대/최솟값을 구할 때 반드시 삼분 탐색을 이용하기보다는, **미분이 불가능하거나 도함수를 구하기 어려운 경우**에 사용하게 된다.

또, 삼분 탐색을 이용할 때 주의해야하는 점은 **기울기가 0인 구간**의 존재 유무이다.

만약 구간을 나누는 $p, q$가 모두 기울기가 0인 구간에 포함된다면, 아래 그림처럼 어느 쪽으로 구간을 좁혀야하는지 알 수 없게 된다.

<center><img src="https://user-images.githubusercontent.com/88201512/150106671-7671e38a-5ebb-43e1-99d8-69d81a67005c.jpg" width="60%" height="60%"></center>

(물론 기울기가 0인 구간이 최솟값에 해당된다면 상관없다.)

<br/>

## 3. Implementation

삼분 탐색을 이용해서 해결할 수 있는 문제를 풀어볼 것이다.

### [백준] 8986. 전봇대

[백준 8986. 전봇대 문제 링크](https://www.acmicpc.net/problem/8986)

x축 위에 N개의 전봇대가 나열되어 있다.($1 \leq N \leq 100000$)

이 전봇대들을 이웃한 두 전봇대 사이의 거리가 모두 일정하도록 일부 전봇대들을 옮기려고 한다.

이때 이동해야하는 전봇대들의 거리의 합이 최소인 경우를 구하는 문제이다.

단, 전봇대는 항상 정수 좌표에만 있을 수 있으며 가장 왼쪽에 위치한 전봇대의 위치는 0으로 고정되어 있으며 움직일 수 없다.

**[Solution]**

전봇대들의 초기 위치를 $x_0, x_1, \dots, x_{N-1}$이라 하고, 이웃한 전봇대 사이의 거리를 $d$라고 하면, 전봇대들의 이동거리 합 $f(d)$는 다음과 같다.

\begin{aligned}
f(d) = \sum_{i = 0}^{N-1} \left\vert id - x_i \right\vert
\end{aligned}

우리는 $f(d)$를 최소로 만드는 $d$의 값을 구하고자 한다.

함수 $f(d)$의 그래프가 어떤 형태를 가질지 생각해보자.

1. 절댓값들의 합으로 이루어진 함수이므로, 각 절댓값이 0이 되는 $d$값을 경계로 함수가 달라지게 된다.
2. 각 구간에서 $f(d)$의 그래프는 선분이며, 오른쪽에 있는 구간일수록 기울기가 점차 커지게 된다.

즉, 아래 그래프와 같은 형태를 가질 것이다.

<center><img src="" width="60%" height="60%"></center>

따라서 $f(d)$는 항상 아래로 볼록한 함수로, 삼분 탐색을 적용할 수 있다는 사실을 알 수 있다.





이처럼 삼분 탐색을 이용하는 문제의 핵심은 문제에서 **최대/최솟값을 구해야하는 함수가 삼분 탐색을 이용할 수 있는 함수인지 판단**하는 것이 가장 중요하다.



