---
title: "A* search algorithm"
toc: true
toc_label: "On this page"
toc_icon: "chevron-right"
categories:
  - Algorithm
use_math: true
comments: true

---

`Tags` 최단 경로 문제, 휴리스틱 알고리즘, Heuristic

## 1. Introduction to A* search algorithm

A* 알고리즘은 주어진 출발 지점에서 목표 지점까지 가는 최단 경로를 찾아내는 그래프 탐색 알고리즘이다.

**A* 알고리즘은 각 정점** $n$**에 대해 해당 꼭짓점을 통과하는 최상의 경로를 추정한 휴리스틱 추정값** $h(n)$을 이용한다.

휴리스틱 추정값을 기반으로 각 정점에 대한 평가 함수를 구하고, 우선순위 큐를 이용해 평가 함수로 구한 값의 순서대로 정점을 방문하면서 최단 경로를 찾는 알고리즘이다.

우선순위 큐를 이용하여 최단 경로를 구하는 알고리즘이라는 점에서 다익스트라 알고리즘과 비슷하다.

다만,다익스트라는 출발 지점으로부터 다른 모든 정점까지의 최단 거리를 구하는 알고리즘이지만, A* 알고리즘은 도착 지점까지 정해져 있다.

A* 알고리즘은 출발 지점으로부터 도착 지점까지의 최단 경로를 찾기 위해 각 정점마다 다음과 같은 평가 함수 $f(n)$를 정의한다.

\begin{aligned}
f(n) = g(n) + h(n)
\end{aligned}

- $g(n)$: 출발 정점으로부터 정점 $v$까지의 경로 가중치
- $h(n)$: 정점 $v$로부터 목표 정점까지의 **추정 경로 가중치**

A* 알고리즘은 $h(n)$를 어떻게 구하느냐에 따라서 얼마나 빨리 최단 경로를 찾을 수 있는지가 달라지게 된다.

가장 대표적인 휴리스틱 함수로는 **맨해튼 거리 함수**와 **유클리드 거리 함수**가 있다.

---

A* 알고리즘은 두 저장소, **열린 목록(Open List)**와 **닫힌 목록(Close List)**를 사용한다.

열린 목록에는 탐색 중인 정점들이, 닫힌 목록에는 탐색을 마친 정점들이 들어가게 된다.

알고리즘은 다음과 같다.

1. 아래 과정을 $n$이 목표 정점일 때까지 반복한다.
2. 열린 목록에 있는 정점들 중 평가 함수 $f(n)$이 가장 작은 정점 $n$을 선택한다.
3. 해당 정점에서 이동할 수 있는 정점 $v$에 대해,
  3-1. $v$가 닫힌 목록에 있으면 이동할 수 있는 다음 정점을 탐색  
  3-2. 정점 $n$을 거쳐 $v$로 오는 경로의 길이를 구해 얻은 $f'$이 기존 평가함수보다 더 작으면 평가함수를 갱신한다.
4. 정점 $n$에 대한 탐색을 마쳤으므로 닫힌 목록에 추가한다.

---

<br/>

## 2. How to choose a good Heuristic function

### 2-1. Properties about A* Algorithm

A* 알고리즘은 어떤 휴리스틱 함수를 사용하느냐에 따라 다음과 같은 성질들을 갖는다.

노드 $n$에서 목표 지점까지의 최단 거리를 $d(n)$, 추정치를 $h(n)$이라고 하자.

출발 지점에서 노드 $n$까지의 거리는 $g(n)$이다.

- 모든 $n$에 대해 $h(n) = 0$: 다익스트라 알고리즘(Dijkstra's algortihm)이 된다.
- 모든 $n$에 대해 $h(n) \leq d(n)$: 알고리즘을 통해 최단 경로를 찾을 수 있음이 보장된다. 이때 $h(n)$이 작을수록 더 많은 노드를 탐색하게 되어 시간이 더 오래 걸린다.
- $h(n) = d(n)$: 알고리즘은 최단 경로를 따라서만 탐색하기 때문에 매우 빠르게 찾게 된다.
- 어떤 $n$에 대해 $h(n) > d(n)$: 알고리즘을 통해 최단 경로를 찾을 수 있다는 사실이 보장되지 않는다. 그러나 더 빠르게 동작할 수는 있다.
- $h(n)$이 $g(n)$에 비해 매우 큰 경우: $h(n)$의 영향만을 받게 되므로 Greedy Best-First Search가 된다.

---

### 2-2. Trade-off between Speed & Accuracy

앞서 언급했던 성질들에서 알 수 있듯이, 어떤 휴리스틱 함수를 사용하느냐에 따라 A* 알고리즘은 최단 경로를 반환하지 않을 수도 있다.

하지만, 그렇다고 해당 알고리즘이 쓸모가 없는 것은 아니다.

예를 들어 우리가 어떤 게임을 개발하고 있다고 하자.

캐릭터를 한 곳에서 다른 곳으로 이동시키는 명령이 입력되었을 때, 캐릭터가 어떤 경로를 따라서 이동해야하는지를 구하는 알고리즘을 만들어야한다.

대부분의 게임에서는 굳이 엄밀한 **최단 경로**를 구하기보다는 **최단 경로와 비슷한 경로**를 구해도 큰 문제가 없다.



위와 같은 A* 알고리즘의 성질은 **최단 경로(perfect path)**보다 **적절한 경로(good path)**만 찾아도 괜찮을 수 있다.


그렇다면 적절한 휴리스틱 함수는 어떻게 찾을 수 있을까?




## 3. Implementation

이번에는 직접 A* 알고리즘을 이용해서 문제를 풀어보도록 하자.
















