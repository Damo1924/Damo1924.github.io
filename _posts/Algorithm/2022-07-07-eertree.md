---
title: "EERTREE (Palindromic Tree)"
toc: true
toc_label: "On this page"
toc_icon: "chevron-right"
categories:    
  - Algorithm
use_math: true
comments: true

---

`Tags` 문자열 알고리즘, 펠린드롬, 회문

## 1. Number of Palindrome Substrings

어떤 문자열 $S$의 팰린드롬인 부분문자열 중 서로 다른 것들의 개수는 몇 개 일까?

정확한 개수는 직접 구해보아야 알 수 있겠지만, **최댓값은 $n$개**라는 사실을 아래와 같이 증명할 수 있다.

> **Proof.** 수학적 귀납법을 이용해서 증명해보자.
> 
> 먼저, 길이가 $1$인 문자열의 경우 해당 문자열이 유일한 펠린드롬이므로 성립한다.
> 
> 이제 길이가 $k$인 문자열 $S_1 S_2 \dots S_k$에 대하여 위 성질이 성립한다고 가정하자.
> 
> 위 문자열에 새로운 문자 하나를 추가했을 때, 기존에 없었던 팰린드롬이 두 개 생긴다고 가정하자.
> 
> 새로운 문자를 추가한 문자열을 $S_1 S_2 \dots S_{k+1}$,
> 
> $i < j$ 에 대하여 새로운 팰린드롬을 $S_i \dots S_{k+1}$ 과 $S_j \dots S_{k+1}$
> 
> 이라고 하자. 그러면 $S_i \dots S_{k+1}$ 이 팰린드롬이므로 $S_i \dots S_{k + 1 + i - j}$ 는 $S_j \dots S_{k+1}$ 을 뒤집은 문자열이 된다.
> 
> 그런데 $S_j \dots S_{k+1}$ 도 팰린드롬이므로 $S_i \dots S_{k+1+i-j}$ 도 팰린드롬이 되고, 이는 기존 문자열에 동일한 팰린드롬이 존재한다는 것을 의미한다.
> 
> 귀류법에 의해서 **새로운 문자 하나를 추가했을 때, 기존 문자열에 없었던 두 개 이상의 팰린드롬이 생길 수 없다**는 것을 알 수 있다.
> 
> 따라서 길이가 $k$인 문자열에 존재하는 서로 다른 팰린드롬의 개수가 $k$개 이하이면, 길이가 $k+1$인 문자열에는 최대 $k+1$개만 존재할 수 있게 된다.
> 
> 수학적 귀납법에 의해 증명이 완료된다.

우리는 다음과 같은 재미있는 성질들을 이끌어 낼 수 있다.

- 문자열 $S$에 새로운 문자 $c$를 추가할 때 새로 추가되는 팰린드롬의 수는 최대 1개이다.
- 새로 추가되는 팰린드롬으로 가능한 것은 문자열 $Sc$의 가장 긴 팰린드롬 접미사이다.
- 
